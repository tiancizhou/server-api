# 卡密管理后台使用指南

## 📌 快速开始

### 1. 启动服务

```bash
# 方法一：单窗口启动（推荐）
start-combined.bat

# 方法二：手动启动
npm start
```

### 2. 访问后台

**本地访问**：http://localhost:5200/admin  
**外网访问**：通过 natapp 提供的域名 + `/admin`

**默认密码**：`admin123`

---

## 🎯 闲鱼发货完整流程

### 步骤 1：导入卡密

1. 打开从卡渠道下载的 txt 文件
2. 复制所有内容，例如：
   ```
   卡密: mio-5bc74faf-d431-4993-b3fa-f6fcb0c51f81 额度: 0 有效期: 1小时
   卡密: mio-37011ba0-ae52-4833-93ea-ec4dda65c2cb 额度: 0 有效期: 1小时
   ```
3. 登录管理后台
4. 找到"📥 批量导入卡密"区域
5. 粘贴到文本框
6. 点击"导入卡密"按钮
7. 查看导入结果（新增、重复、无效数量）

### 步骤 2：接收闲鱼订单

买家在闲鱼下单后，你会收到通知

### 步骤 3：发货（重点）⚡

1. 打开管理后台
2. 找到"⚡ 快速操作"区域
3. 点击"📋 获取下一个卡密并复制"
4. 卡密已自动复制到剪贴板
5. 打开闲鱼对话框
6. 按 `Ctrl+V` 粘贴卡密
7. 发送给买家
8. **重要**：返回管理后台，点击"✓ 已发货，标记为已售出"
9. 完成！

### 步骤 4：自动处理

- 买家收到卡密后，在你的网站激活
- 系统自动标记该卡密为"已使用"
- 库存自动更新

---

## 📊 库存管理

### 查看统计

后台顶部显示实时统计：
- **总卡密数**：所有导入的卡密
- **可用卡密**：还可以发货的数量（重点关注）
- **已售出**：已发货但未激活的数量
- **已使用**：买家已激活的数量

### 筛选查看

点击筛选按钮查看不同状态的卡密：
- **全部**：所有卡密
- **可用**：可以发货的卡密
- **已售出**：已发货待激活
- **已使用**：已激活的卡密

### 库存预警

⚠️ 当可用卡密 < 10 时，建议及时补货

---

## 🗑️ 数据清理

### 清理已使用的卡密

1. 点击"🗑️ 清理已使用"按钮
2. 确认删除
3. 系统会删除所有已使用的卡密
4. 建议每周清理一次

**注意**：
- 清理前建议备份 `data/cards.json`
- 清理不会影响可用和已售出的卡密

---

## 🔐 安全设置

### 修改管理密码

**临时修改**（重启失效）：
```bash
# Windows PowerShell
$env:ADMIN_PASSWORD="your_strong_password"
npm start
```

**永久修改**：
编辑 `server.js` 文件，修改这一行：
```javascript
const ADMIN_PASSWORD = 'your_strong_password';
```

### 密码要求

- 建议使用 10 位以上的强密码
- 包含大小写字母、数字、特殊字符
- 不要使用常见密码
- 不要泄露给他人

---

## 💾 数据备份

### 备份文件位置

```
data/cards.json  # 所有卡密数据
```

### 备份方法

**方法一：手动复制**
1. 找到项目目录下的 `data` 文件夹
2. 复制整个 `data` 文件夹到安全位置
3. 建议每天备份一次

**方法二：自动备份**
可以使用 Windows 任务计划程序设置定时复制

### 恢复数据

1. 停止服务
2. 将备份的 `data` 文件夹复制回项目目录
3. 重启服务

---

## ⚠️ 常见问题

### Q1: 导入卡密后数量不对？

**原因**：可能包含重复卡密或无效格式  
**解决**：查看导入结果，显示了新增、重复、无效的数量

### Q2: 点击"获取下一个卡密"显示"没有可用的卡密"？

**原因**：库存已空或所有卡密都已标记为已售/已使用  
**解决**：
1. 检查统计信息中的"可用卡密"数量
2. 如果为 0，需要导入新的卡密
3. 或检查是否有误标记的卡密

### Q3: 发货后忘记点"标记为已售出"怎么办？

**影响**：下次可能会重复发货同一个卡密  
**解决**：
1. 在卡密列表中找到该卡密
2. 点击"标记已售"按钮
3. 或等买家激活后自动标记为"已使用"

### Q4: 如何查找已发货的卡密？

**方法**：
1. 点击"已售出"筛选按钮
2. 查看"售出时间"列
3. 可以记录买家信息（点击列表中的卡密备注）

### Q5: 可以同时多个人管理吗？

**答**：可以，但需要注意：
- 使用同一个密码登录
- 发货后立即标记，避免重复发货
- 建议一个人负责发货

---

## 📱 移动端使用

管理后台支持移动端浏览器访问：

1. 在手机浏览器中打开管理后台地址
2. 登录后可以进行所有操作
3. 复制功能完美支持移动端

**适合场景**：
- 外出时需要发货
- 随时查看库存
- 移动办公

---

## 🎓 最佳实践

### 1. 发货流程优化

- **不推荐**：先在列表里找卡密 → 复制 → 发送
- **推荐**：点击"获取下一个" → 自动复制 → 粘贴发送 → 标记已售

### 2. 库存管理建议

- 保持可用库存 > 20 个
- 每周清理一次已使用卡密
- 每天备份一次数据

### 3. 安全建议

- 修改默认密码
- 不要公开管理后台地址
- 使用内网穿透时注意 URL 保密

### 4. 效率提升

- 使用快捷键 `Ctrl+V` 快速粘贴
- 在浏览器中收藏管理后台地址
- 同时打开闲鱼和管理后台，方便切换

---

## 📞 技术支持

如有问题，请检查：
1. 服务是否正常运行
2. 网络是否正常
3. 管理密码是否正确
4. 查看控制台错误信息

---

## 🎉 预期效果

使用本系统后，你的发货效率将提升：

**之前**：
1. 打开卡密文件
2. 查找未使用的卡密
3. 手动复制
4. 粘贴到闲鱼
5. 手动标记为已用
6. 耗时：~2分钟/单

**现在**：
1. 点击"获取下一个"
2. 粘贴到闲鱼
3. 点击"标记已售"
4. 耗时：~10秒/单

**效率提升 12 倍！** 🚀

